<h1>浏览帖子</h1>

<table>
  <thead>
    <tr>
      <th>作者</th>
      <th>标题</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @posts.each do |post| %>
      <tr>
        <%if User.find_by_id(post.user_id) %>
        <td><%= User.find_by_id(post.user_id).name %></td>
        <%else%>
        <td>已被删除的用户</td>
        <%end%>
        <td><%= post.title %></td>
        <td><%= link_to '详情', post %></td>
        <%if User.find_by_id(session[:user_id]).admin? or User.find_by_id(session[:user_id]).id==post.user_id%>
        <td><%= link_to '编辑', edit_post_path(post) %></td>
        <td><%= link_to '删除', post, method: :delete, data: { confirm: '此操作不可恢复。继续？' } %></td>
        <%end%>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to '发表帖子', new_post_path %> |
<%= link_to '返回管理员主页', admin_index_path %> |
<%= link_to '返回主页', root_path %>
